webpackJsonp([19],{VUZs:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n#backgounduser[data-v-50257020]{\n  min-height: calc(100vh - 84px - 25px);\n}\n",""])},vekP:function(e,t,a){var r=a("VUZs");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("ceb8d338",r,!0)},zEnY:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("t5DY"),n=a("vMJZ"),s=a("E4LH"),l={name:"index",data:function(){var e=this;return{example:"user",tableHeight:500,ACTIVE:!0,tableData:[],updateVisible:!1,createVisible:!1,createDepartmentsId:"",createRolesId:"",departsmentList:[],rolesList:[],openQuery:{id:"",enabled:""},closeQuery:{id:"",enabled:""},deleteQuery:{id:""},enabledText:{true:"启用",false:"禁用"},departmentsId:"",rolesId:"",updateName:"",updateId:"",multipleSelection:[],createTemp:{username:"",name:"",password:"",password2:"",source:"WEB",backend:!0,roles:[],departments:[]},createObject:{},updateTemp:{id:"",username:"",departmentsId:"",rolesId:""},updateObject:{},formInline:{page:"0",size:10,username:"",name:"",enabled:"",fields:"*,roles,departments",source:"WEB",backend:"1"},total:0,listQuery:{page:"0",size:10,sort:"",fields:"*,roles,departments",source:"WEB",backend:"1",id:3},loadingInstance:"",addRule:{username:[{required:!0,validator:function(e,t,a){""===t?a(new Error("请输入手机号")):Object(s.d)(t)?a():a(new Error("请输入正确的电话号码形式(只能为11位数字)"))},trigger:"blur"}],name:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,validator:function(t,a,r){""===a?r(new Error("请输入密码")):Object(s.f)(a)?""!=e.createTemp.password2?(e.$refs.createForm.validateField("password2"),r()):r():r(new Error("请输入由数字,英文字母，下划线组成的6~18密码"))},trigger:"blur"}],password2:[{required:!0,validator:function(t,a,r){""===a?r(new Error("请再次输入密码")):Object(s.f)(a)?a!==e.createTemp.password?r(new Error("两次输入密码不一致!")):r():r(new Error("请输入由数字,英文字母，下划线组成的6~18密码"))},trigger:"blur"}],createDepartmentsId:[{required:!0,message:"请选择部门",trigger:"blur"}],createRolesId:[{required:!0,message:"请选择角色",trigger:"blur"}]},updateRule:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],departmentsId:[{required:!0,message:"请选择部门",trigger:"blur"}],rolesId:[{required:!0,message:"请选择角色",trigger:"blur"}]}}},computed:{timestampToTime:function(){return r.l},getButtons:function(){return r.g}},mounted:function(){this.getUser();var e=this.$refs.height.offsetHeight;this.tableHeight=e-63-128-30},methods:{sortList:function(e){var t="";e.order&&e.prop?(t="descending"===e.order?",desc":"ascending"===e.order?",asc":"",this.listQuery.sort=e.prop+t):this.listQuery.sort="createdAt,desc",this.getUser()},enabledF:function(e){var t=this;if(0==this.multipleSelection.length)return!1;this.multipleSelection.forEach(function(a,n){t.closeQuery={id:a.id,enabled:e},Object(r.c)(t.example,t.closeQuery).then(function(a){t.multipleSelection[n].enabled=e,n==t.multipleSelection.length-1&&t.$notify({title:"成功",message:t.enabledText[e]+"成功",type:"success",duration:2e3})})})},deleteUser:function(){var e=this;if(0==this.multipleSelection.length)return!1;this.multipleSelection.forEach(function(t,a){e.deleteQuery={id:t.id},Object(r.b)(e.example,e.deleteQuery).then(function(t){e.tableData.splice(a,1),a==e.multipleSelection.length-1&&e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})})})},handleUpdate:function(e){var t=this;0==this.rolesList.length&&(Object(n.b)().then(function(e){t.rolesList=e.data||[]}),Object(n.a)().then(function(e){t.departsmentList=e.data||[]})),this.updateTemp={id:e.id,username:e.name,departmentsId:"{}"==e.departments?e.departments[0].id:"",rolesId:"{}"==e.roles?e.roles[0].id:""},this.updateVisible=!0,this.$nextTick(function(){t.$refs.updateForm.clearValidate()})},updateDate:function(){var e=this;this.updateObject={id:this.updateTemp.id,backend:!0,name:this.updateTemp.username,roles:[{id:this.updateTemp.rolesId}],departments:[{id:this.updateTemp.departmentsId}]},this.$refs.updateForm.validate(function(t){t&&Object(r.n)(e.example,e.updateObject).then(function(t){e.updateVisible=!1,e.resetForm("updateForm"),e.getUser(),e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})}).catch(function(e){console.log(e)})})},handleCreate:function(e){var t=this;this.createTemp.roles=[],this.createTemp.departments=[],this.createVisible=!0,0==this.rolesList.length&&(Object(n.b)().then(function(e){t.rolesList=e.data||[]}),Object(n.a)().then(function(e){t.departsmentList=e.data||[]})),this.$nextTick(function(){t.$refs.createForm.clearValidate()})},createDate:function(){var e=this;this.createObject={username:this.createTemp.username,name:this.createTemp.name,password:this.createTemp.password,password2:this.createTemp.password2,source:"WEB",backend:!0,departments:[{id:this.createTemp.createDepartmentsId}],roles:[{id:this.createTemp.createRolesId}]},this.$refs.createForm.validate(function(t){t&&Object(r.a)(e.example,e.createObject).then(function(t){e.createVisible=!1,e.resetForm("createForm"),e.getUser(),e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})}).catch(function(t){e.createTemp.roles=[],e.createTemp.departments=[]})})},handleSizeChange:function(e){this.listQuery.size=e,this.getUser()},handleCurrentChange:function(e){this.listQuery.page=e-1,this.getUser()},getUser:function(){var e=this;Object(r.p)(this.example,Object(r.i)(this.listQuery,{id:"!"})).then(function(t){e.tableData=t.data,e.total=t.total})},onSubmit:function(e){var t=this;e?this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;Object(r.d)(t.example,Object(r.f)(t.formInline)).then(function(e){t.tableData=e.data,t.total=e.total})}):(this.formInline.username="",this.formInline.enabled="",this.formInline.name="",Object(r.d)(this.example,Object(r.f)(this.formInline)).then(function(e){t.tableData=e.data,t.total=e.total}))},resetForm:function(e){this.updateVisible=!1,this.createVisible=!1,this.$refs[e].resetFields()},handleSelectionChange:function(e){this.multipleSelection=e}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"height",staticClass:"main",attrs:{id:"backgounduser"}},[a("el-form",{ref:"formInline",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"账号",prop:"username"}},[a("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.formInline.username,callback:function(t){e.$set(e.formInline,"username",t)},expression:"formInline.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户状态",prop:"enabled"}},[a("el-select",{attrs:{placeholder:"选择状态"},model:{value:e.formInline.enabled,callback:function(t){e.$set(e.formInline,"enabled",t)},expression:"formInline.enabled"}},[a("el-option",{attrs:{label:"正常",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"锁定",value:"0"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("formInline")}}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:function(t){e.onSubmit()}}},[e._v("清除")])],1),e._v(" "),a("el-form-item",{staticStyle:{float:"right"}},[e.getButtons("on")?a("el-button",{attrs:{type:"success"},on:{click:e.handleCreate}},[e._v("新增")]):e._e(),e._v(" "),e.getButtons("delete")?a("el-button",{attrs:{type:"danger"},on:{click:e.deleteUser}},[e._v("删除")]):e._e(),e._v(" "),e.getButtons("on")?a("el-button",{on:{click:function(t){e.enabledF(1)}}},[e._v("启用")]):e._e(),e._v(" "),e.getButtons("off")?a("el-button",{attrs:{type:"warning"},on:{click:function(t){e.enabledF(0)}}},[e._v("禁用")]):e._e()],1)],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,height:e.tableHeight,border:""},on:{"selection-change":e.handleSelectionChange,"sort-change":e.sortList}},[a("el-table-column",{attrs:{align:"center",type:"selection",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"username",label:"账号",width:"200",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"name",label:"用户名",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"角色",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.roles.length<1?a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[e._l(t.row.roles,function(t){return a("p",{key:t.id},[e._v(e._s(t.name))])}),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.roles[0].name))])],1)],2):a("span",[e._v(e._s(void 0==t.row.roles.length?"-":t.row.roles[0].name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"部门",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.departments.length<1?a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[e._l(t.row.departments,function(t){return a("p",{key:t.id},[e._v(e._s(t.name))])}),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.departments[0].name))])],1)],2):a("span",[e._v(e._s(void 0==t.row.departments.length?"-":t.row.departments[0].name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"enabled",label:"状态",width:"100",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:{active:!t.row.enabled}},[e._v(e._s(1==t.row.enabled?"正常":"锁定"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"createdAt",label:"创建时间",width:"200",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.timestampToTime(t.row.createdAt)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"lastLoginAt",label:"最后登录时间",width:e.getButtons("edit")?200:"",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.lastLoginAt?e.timestampToTime(t.row.lastLoginAt):"未知"))])]}}])}),e._v(" "),e.getButtons("edit")?a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",icon:"el-icon-edit",type:"text"},on:{click:function(a){e.handleUpdate(t.row)}}},[e._v("编辑")])]}}])}):e._e()],1),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":1,"page-sizes":[10,20,30,40],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{title:"新增后台用户",width:"30%",visible:e.createVisible},on:{"update:visible":function(t){e.createVisible=t}}},[a("el-form",{ref:"createForm",staticStyle:{"max-width":"400px"},attrs:{rules:e.addRule,model:e.createTemp,"label-position":"right","label-width":"100px"}},[a("el-form-item",{attrs:{label:"手机号",prop:"username"}},[a("el-input",{model:{value:e.createTemp.username,callback:function(t){e.$set(e.createTemp,"username",t)},expression:"createTemp.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"name"}},[a("el-input",{model:{value:e.createTemp.name,callback:function(t){e.$set(e.createTemp,"name",t)},expression:"createTemp.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.createTemp.password,callback:function(t){e.$set(e.createTemp,"password",t)},expression:"createTemp.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"password2"}},[a("el-input",{attrs:{type:"password"},model:{value:e.createTemp.password2,callback:function(t){e.$set(e.createTemp,"password2",t)},expression:"createTemp.password2"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门",prop:"createDepartmentsId"}},[a("el-select",{attrs:{placeholder:"选择部门"},model:{value:e.createTemp.createDepartmentsId,callback:function(t){e.$set(e.createTemp,"createDepartmentsId",t)},expression:"createTemp.createDepartmentsId"}},e._l(e.departsmentList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"createRolesId"}},[a("el-select",{attrs:{placeholder:"选择角色"},model:{value:e.createTemp.createRolesId,callback:function(t){e.$set(e.createTemp,"createRolesId",t)},expression:"createTemp.createRolesId"}},e._l(e.rolesList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.resetForm("createForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.createDate}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑后台用户",width:"30%",visible:e.updateVisible},on:{"update:visible":function(t){e.updateVisible=t}}},[a("el-form",{ref:"updateForm",attrs:{rules:e.updateRule,model:e.updateTemp,"label-position":"right","label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.updateTemp.username,callback:function(t){e.$set(e.updateTemp,"username",t)},expression:"updateTemp.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门",prop:"departmentsId"}},[a("el-select",{attrs:{placeholder:"选择部门"},model:{value:e.updateTemp.departmentsId,callback:function(t){e.$set(e.updateTemp,"departmentsId",t)},expression:"updateTemp.departmentsId"}},e._l(e.departsmentList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"rolesId"}},[a("el-select",{attrs:{placeholder:"选择角色"},model:{value:e.updateTemp.rolesId,callback:function(t){e.$set(e.updateTemp,"rolesId",t)},expression:"updateTemp.rolesId"}},e._l(e.rolesList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.resetForm("updateForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.updateDate}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(l,i,!1,function(e){a("vekP")},"data-v-50257020",null);t.default=o.exports}});